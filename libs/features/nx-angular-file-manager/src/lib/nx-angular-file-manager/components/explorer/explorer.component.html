<div class="nx-file-manager-explorer">
  <div
    #filesContainer
    class="files grid-view"
    (click)="onFilesAreaClick($event)"
  >
    @for (file of tabData.files; track $index) {
    <button
      [id]="file.id"
      class="file"
      [class]="{
        selected: file.isSelected,
        hoverable: !isSelecting,
        droppable: file.isDroppable,
        'drop-not-allowed': file.isDroppable && !file.isDropAllowed,
        'drop-allowed': file.isDroppable && file.isDropAllowed,
        'drop-unavailable':
          selectedFiles.length > 0 && !file.isSelected && file.isDropUnavailable
      }"
      [draggable]="true"
      [attr.data-tippy-content]="file.name"
      (dragstart)="onFileDragStart($event, file)"
      (drag)="onFileDragging($event)"
      (dragend)="onFileDragEnd($event)"
      (dragover)="onFileDragOver($event, file)"
      (dragleave)="onFileDropLeave($event, file)"
      (drop)="onFileDrop($event, file)"
      (click)="onFileClick($event, file)"
      [contextMenu]="fileContextMenu"
      [contextMenuValue]="file"
    >
      @if (UrlUtils.isHttpUrl(file.icon)) {
      <img [src]="file.icon" class="icon image" [alt]="file.name" />
      } @else {
      <svg viewBox="0 0 24 24" width="20" class="icon">
        <path [attr.d]="iconSet[file.icon]" />
      </svg>
      }

      <span class="name">
        {{ file.name }}
      </span>
    </button>
    }

    <!-- Drag Ghost -->
    <div #dragGhost class="drag-ghost">
      <svg viewBox="0 0 24 24" width="20" class="icon">
        <path [attr.d]="iconSet['fileMultipleIconData']" />
      </svg>

      <span> {{ selectedFiles.length || 1 }} files selected </span>
    </div>
  </div>
</div>

<context-menu #fileContextMenu>
  <!-- each menu item is a <ng-template>... -->
  <ng-template contextMenuItem [passive]="true">
    <!-- ...that can contain any HTML with specific styling -->
    <span class="menu-item-title">Context menu title</span>
  </ng-template>
  <!-- ...not the `let-value` to access the context menu value inside the template -->
  <ng-template contextMenuItem [passive]="true" let-value
    >This is the context menu value "{{ value }}"</ng-template
  >
  <!-- ...or just text, the (execute) output is called when the menu item is clicked -->
  <ng-template contextMenuItem (execute)="execute('Cut', $event)" let-value
    >Cut {{ value }}</ng-template
  >
  <ng-template contextMenuItem (execute)="execute('Copy', $event)" let-value
    >Copy {{ value }}</ng-template
  >
  <ng-template contextMenuItem (execute)="execute('Paste', $event)" let-value
    >Paste {{ value }}</ng-template
  >
  <ng-template contextMenuItem [disabled]="true"
    >Disabled menu item</ng-template
  >
</context-menu>
