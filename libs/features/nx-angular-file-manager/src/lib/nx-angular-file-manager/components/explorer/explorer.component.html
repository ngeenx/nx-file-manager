<div class="nx-file-manager-explorer" (mousedown)="onExplorerClick($event)">
  <div
    #filesContainer
    class="files grid-view"
    (mousedown)="onFilesAreaClick($event)"
    (dragenter)="onFilesAreaDragEnter($event)"
    (dragover)="onFilesAreaDragEnter($event)"
    (drop)="onFilesAreaDrop($event)"
  >
    @for (file of tabData.files; track $index) {
    <button
      [id]="file.id"
      class="file"
      [class]="{
        selected: file.isSelected,
        hoverable: !isSelecting,
        'drop-not-allowed': file.isDroppable && !file.isDropAllowed,
        'drop-allowed': file.isDroppable && file.isDropAllowed,
        'drop-unavailable':
          selectedFiles.length > 0 &&
          !file.isSelected &&
          file.isDropUnavailable,
        uploading: file.isUploading,
        'waiting-for-upload': file.isReadyForUpload
      }"
      [draggable]="true"
      [attr.data-tippy-content]="file.name"
      (dragstart)="onFileDragStart($event, file)"
      (drag)="onFileDragging($event)"
      (dragend)="onFileDragEnd($event)"
      (dragover)="onFileDragOver($event, file)"
      (dragleave)="onFileDropLeave($event, file)"
      (drop)="onFileDrop($event, file)"
      (mousedown)="onFileClick($event, file)"
      [contextMenu]="fileContextMenu"
      [contextMenuValue]="file"
    >
      @if (UrlUtils.isHttpUrl(file.icon)) {
      <img [src]="file.icon" class="icon image" [alt]="file.name" />
      } @else {
      <svg viewBox="0 0 24 24" width="20" class="icon">
        <path [attr.d]="iconSet[file.icon]" />
      </svg>
      }

      <span class="name">
        {{ file.name }}
      </span>
    </button>
    }

    <!-- Drag Zone -->
    <div
      class="drag-zone"
      [class]="{
        active: isDragZoneActive
      }"
      (dragover)="onFilesAreaDragEnter($event)"
      (dragleave)="onFilesAreaDragLeave($event)"
    >
      <div class="drag-zone-inner">
        <h1 class="title">Drop files here</h1>
      </div>
    </div>

    <!-- Drag Ghost -->
    <div #dragGhost class="drag-ghost">
      <svg viewBox="0 0 24 24" width="20" class="icon">
        <path [attr.d]="iconSet['fileMultipleIconData']" />
      </svg>

      <span>
        {{ selectedFiles.length || 1 }}
        {{ selectedFiles.length > 1 ? 'files' : 'file' }} selected
      </span>
    </div>
  </div>
</div>

<context-menu #fileContextMenu>
  <ng-template
    contextMenuItem
    (execute)="execute(FileActionType.RENAME, $event)"
    let-value
  >
    Rename
  </ng-template>
  <ng-template
    contextMenuItem
    (execute)="execute(FileActionType.CUT, $event)"
    let-value
  >
    Cut
  </ng-template>
  <ng-template
    contextMenuItem
    (execute)="execute(FileActionType.COPY, $event)"
    let-value
  >
    Copy
  </ng-template>
  <ng-template
    contextMenuItem
    (execute)="execute(FileActionType.PASTE, $event)"
    let-value
  >
    Paste
  </ng-template>
  <ng-template
    contextMenuItem
    (execute)="execute(FileActionType.MOVE, $event)"
    let-value
  >
    Move
  </ng-template>
  <ng-template
    contextMenuItem
    (execute)="execute(FileActionType.DELETE, $event)"
    let-value
  >
    Delete
  </ng-template>
</context-menu>
