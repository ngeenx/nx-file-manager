<div class="nx-file-manager-explorer">
  <div
    #filesContainer
    class="files grid-view"
    (click)="onFilesAreaClick($event)"
    (dragenter)="onFilesAreaDragEnter($event)"
    (dragover)="onFilesAreaDragEnter($event)"
    (drop)="onFilesAreaDrop($event)"
    (dragleave)="onFilesAreaDragLeave($event)"
  >
    @for (file of tabData.files; track $index) {
    <button
      [id]="file.id"
      class="file"
      [class]="{
        selected: file.isSelected,
        hoverable: !isSelecting,
        'drop-not-allowed': file.isDroppable && !file.isDropAllowed,
        'drop-allowed': file.isDroppable && file.isDropAllowed,
        'drop-unavailable':
          selectedFiles.length > 0 && !file.isSelected && file.isDropUnavailable
      }"
      [draggable]="true"
      [attr.data-tippy-content]="file.name"
      (dragstart)="onFileDragStart($event, file)"
      (drag)="onFileDragging($event)"
      (dragend)="onFileDragEnd($event)"
      (dragover)="onFileDragOver($event, file)"
      (dragleave)="onFileDropLeave($event, file)"
      (drop)="onFileDrop($event, file)"
      (click)="onFileClick($event, file)"
      [contextMenu]="fileContextMenu"
      [contextMenuValue]="file"
    >
      @if (UrlUtils.isHttpUrl(file.icon)) {
      <img [src]="file.icon" class="icon image" [alt]="file.name" />
      } @else {
      <svg viewBox="0 0 24 24" width="20" class="icon">
        <path [attr.d]="iconSet[file.icon]" />
      </svg>
      }

      <span class="name">
        {{ file.name }}
      </span>
    </button>
    }

    <!-- Drag Zone -->
    <div
      class="drag-zone"
      [class]="{
        active: isDragZoneActive
      }"
      (dragover)="onFilesAreaDragEnter($event)"
      (dragleave)="onFilesAreaDragLeave($event)"
    >
      <div class="drag-zone-inner">
        <h1 class="title">Drop files here</h1>
      </div>
    </div>

    <!-- Drag Ghost -->
    <div #dragGhost class="drag-ghost">
      <svg viewBox="0 0 24 24" width="20" class="icon">
        <path [attr.d]="iconSet['fileMultipleIconData']" />
      </svg>

      <span>
        {{ selectedFiles.length || 1 }}
        {{ selectedFiles.length > 1 ? 'files' : 'file' }} selected
      </span>
    </div>
  </div>
</div>

<context-menu #fileContextMenu>
  <ng-template contextMenuItem (execute)="execute('Rename', $event)" let-value>
    Rename
  </ng-template>
  <ng-template contextMenuItem (execute)="execute('Cut', $event)" let-value>
    Cut
  </ng-template>
  <ng-template contextMenuItem (execute)="execute('Copy', $event)" let-value>
    Copy
  </ng-template>
  <ng-template contextMenuItem (execute)="execute('Paste', $event)" let-value>
    Paste
  </ng-template>
  <ng-template contextMenuItem (execute)="execute('Move', $event)" let-value>
    Move
  </ng-template>
  <ng-template contextMenuItem (execute)="execute('Delete', $event)" let-value>
    Delete
  </ng-template>
</context-menu>
